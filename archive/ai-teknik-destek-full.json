{
  "name": "AI Teknik Destek - Full",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "teknik-destek",
        "responseMode": "responseNode"
      },
      "id": "webhook-trigger",
      "name": "Email Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "message",
        "model": "gpt-4",
        "messages": {
          "messageType": "multipleMessages",
          "messages": [
            {
              "role": "system",
              "content": "Sen MOTTONI Cold Foil makinesi teknik uzmanƒ±sƒ±n. M√º≈üteri sorularƒ±nƒ± T√ºrk√ße analiz et, teknik bilgi bankasƒ±ndan cevap bul ve m√º≈üterinin dilinde (ƒ∞ngilizce/Rus√ßa/T√ºrk√ße) profesyonel cevap hazƒ±rla. Makine √∂zellikleri: 35x50cm, 50x70cm, 70x100cm, 100x140cm formatlarƒ±. Foil tasarruf sistemi, √ßoklu folyo kullanƒ±mƒ±, CE sertifikalƒ±."
            },
            {
              "role": "user",
              "content": "M√º≈üteri Sorusu: {{ $json.body.question }}\nM√º≈üteri Dili: {{ $json.body.language }}\nMakine Modeli: {{ $json.body.machine_model }}\nM√º≈üteri Email: {{ $json.body.customer_email }}"
            }
          ]
        }
      },
      "id": "ai-analiz",
      "name": "AI Soru Analizi",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1,
      "position": [460, 300]
    },
    {
      "parameters": {
        "url": "https://api.deepl.com/v2/translate",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "DeepL-Auth-Key YOUR_DEEPL_KEY"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "text",
              "value": "={{ $json.choices[0].message.content }}"
            },
            {
              "name": "target_lang",
              "value": "={{ $('Email Webhook').item.json.body.language === 'EN' ? 'EN' : $('Email Webhook').item.json.body.language === 'RU' ? 'RU' : 'TR' }}"
            }
          ]
        }
      },
      "id": "ceviri",
      "name": "√áeviri",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [680, 300]
    },
    {
      "parameters": {
        "url": "https://api.turbo-smtp.com/api/mail/send",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer YOUR_TURBOSMTP_KEY"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "from",
              "value": "ahmet@mottoni.com"
            },
            {
              "name": "to",
              "value": "={{ $('Email Webhook').item.json.body.customer_email }}"
            },
            {
              "name": "subject",
              "value": "Re: {{ $('Email Webhook').item.json.body.subject || 'MOTTONI Technical Support' }}"
            },
            {
              "name": "content",
              "value": "={{ $json.translations ? $json.translations[0].text : $('AI Soru Analizi').item.json.choices[0].message.content }}"
            }
          ]
        }
      },
      "id": "email-gonder",
      "name": "Email G√∂nder",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [900, 300]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": "YOUR_GOOGLE_SHEETS_ID",
        "sheetName": "TEKNIK_SORULAR",
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Tarih": "={{ new Date().toISOString() }}",
            "M√º≈üteri": "={{ $('Email Webhook').item.json.body.customer_email }}",
            "Firma": "={{ $('Email Webhook').item.json.body.company_name || 'Bilinmiyor' }}",
            "Soru": "={{ $('Email Webhook').item.json.body.question }}",
            "MakineModeli": "={{ $('Email Webhook').item.json.body.machine_model || 'Belirtilmemi≈ü' }}",
            "Cevap": "={{ $('√áeviri').item.json.translations ? $('√áeviri').item.json.translations[0].text : $('AI Soru Analizi').item.json.choices[0].message.content }}",
            "Dil": "={{ $('Email Webhook').item.json.body.language }}",
            "Durum": "Cevaplandƒ±",
            "EmailG√∂nderildi": "Evet"
          }
        }
      },
      "id": "kayit",
      "name": "Google Sheets Kayƒ±t",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [900, 480]
    },
    {
      "parameters": {
        "url": "https://api.telegram.org/botYOUR_BOT_TOKEN/sendMessage",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "chat_id",
              "value": "YOUR_TELEGRAM_CHAT_ID"
            },
            {
              "name": "text",
              "value": "üîß YENƒ∞ TEKNƒ∞K SORU\\n\\nüë§ M√º≈üteri: {{ $('Email Webhook').item.json.body.customer_email }}\\nüè¢ Firma: {{ $('Email Webhook').item.json.body.company_name || 'Bilinmiyor' }}\\n‚ùì Soru: {{ $('Email Webhook').item.json.body.question }}\\nüîß Makine: {{ $('Email Webhook').item.json.body.machine_model || 'Belirtilmemi≈ü' }}\\n‚úÖ Otomatik cevap g√∂nderildi"
            },
            {
              "name": "parse_mode",
              "value": "Markdown"
            }
          ]
        }
      },
      "id": "telegram-bildirim",
      "name": "Telegram Bildirim",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1120, 380]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ { \"status\": \"success\", \"message\": \"Teknik destek talebi i≈ülendi\", \"ticket_id\": \"TECH_\" + new Date().getTime(), \"response_sent\": true } }}"
      },
      "id": "response",
      "name": "Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [1340, 300]
    }
  ],
  "connections": {
    "Email Webhook": {
      "main": [
        [
          {
            "node": "AI Soru Analizi",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Soru Analizi": {
      "main": [
        [
          {
            "node": "√áeviri",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "√áeviri": {
      "main": [
        [
          {
            "node": "Email G√∂nder",
            "type": "main",
            "index": 0
          },
          {
            "node": "Google Sheets Kayƒ±t",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Email G√∂nder": {
      "main": [
        [
          {
            "node": "Telegram Bildirim",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets Kayƒ±t": {
      "main": [
        [
          {
            "node": "Telegram Bildirim",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Bildirim": {
      "main": [
        [
          {
            "node": "Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {},
  "versionId": "1"
}